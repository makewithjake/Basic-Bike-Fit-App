<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Content Security Policy: restricts which external resources can load, helping prevent XSS attacks -->
    <meta http-equiv="Content-Security-Policy" content="default-src 'none'; script-src 'self' https://cdnjs.cloudflare.com; style-src 'self'; img-src 'self' data: blob:; base-uri 'self'; form-action 'none'; object-src 'none'">
    <!-- Page description shown in search engine results -->
    <meta name="description" content="Cycl3D Basic Bike Fit Tool â€“ Upload a side-view photo and get instant angle analysis and fit recommendations for your riding style.">
    <title>Cycl3D Basic Bike Fit Tool</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js" integrity="sha512-qZvrmS2ekKPF2mSznTQsxqPgnpkI4DNTlrdUmTzrDgektczlKNRRhy5X5AAOnx5S09ydFYWWNSfcEqDTTHgtNA==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.8.2/jspdf.plugin.autotable.min.js" integrity="sha512-2/YdOMV+YNpanLCF5MdQwaoFRVbTmrJ4u4EpqS/USXAQNUDgI5uwYi6J98WVtJKcfe1AbgerygzDFToxAlOGEQ==" crossorigin="anonymous"></script>
</head>
<body>
    <div id="cycl3d-app-root">
        <div id="report-wrapper">
            <div class="banner">
                <img src="Assets/cycl3d_banner.webp" alt="Cycl3D Banner">
                <h2>Cycl3D Basic Bike Fit Tool</h2>
            </div>

            <div id="container">
                <!-- The uploaded bike photo. aria-hidden hides it from screen readers since it is purely visual -->
                <img id="displayImg" src="" alt="" aria-hidden="true">
                <!-- The overlay canvas where joint dots and skeleton lines are drawn on top of the photo -->
                <canvas id="skeletonCanvas" aria-label="Bike fit skeleton overlay canvas"></canvas>
            </div>

            <div id="results-area"></div>

            <div class="disclaimer">
                <strong>Legal Disclaimer:</strong> This tool is provided for informational and educational purposes only. Make with Jake LLC and Cycl3D assume no liability for injuries or mechanical failures resulting from use of this application. This software-generated analysis is based on 2D imagery and does not replace the comprehensive assessment of a certified professional bike fitter.
            </div>
        </div>

        <!-- no-print-zone: this section is hidden when printing or generating a PDF report -->
        <div class="no-print-zone">
            <label for="upload">1. Upload Side-View Photo:</label>
            <input type="file" id="upload" accept="image/*" aria-label="Upload a side-view photo of yourself on your bike">
            <label for="fitType">2. Select Riding Style:</label>
            <select id="fitType" aria-label="Select your riding style">
                <option value="Relaxed">Relaxed (Comfort)</option>
                <option value="Balanced" selected>Balanced (All-Road)</option>
                <option value="Aggressive">Aggressive (Race/Aero)</option>
            </select>
        </div>

        <div class="action-buttons">
            <button type="button" id="clearBtn" class="gray-btn">Clear Canvas & Reset</button>
            <button type="button" class="help-btn" id="helpBtn">Help</button>
            <button type="button" class="demo-btn" id="demoBtn">Demo Image</button>
            <button type="button" class="save-btn" id="saveBtn">Save Session</button>
            <button type="button" class="pdf-btn" id="pdfBtn">Download PDF Report</button>
        </div>

        <div id="help-modal">
            <div class="modal-content">
                <span id="closeModal" class="close">&times;</span>
                <h3>How to use the Cycl3D Bike Fit Tool</h3>
                <p>1. Take a clear side-view photo of yourself on your bike. Ensure the entire bike and rider are visible, with the pedal at the 6 o'clock position and hands on the hoods.</p>
                <p>2. Upload the photo using the "Upload" button.</p>
                <p>3. Select your preferred riding style from the dropdown menu.</p>
                <p>4. Starting with the Toe, click on the center of each joint (Ankle, Knee, Hip, Shoulder, Elbow, Hand).</p>
                <p>5. Click and drag each joint to adjust its position</p>
                <p>6. Review the calculated angles and recommendations in the results area.</p>
                <p>7. Use the "Save Session" button to save your current fit data to local storage</p>
                <p>8. Click "Download PDF Report" to generate a PDF summary of your bike fit analysis.</p>
                <button type="button" id="closeHelpBtn">Got it!</button>
            </div>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>